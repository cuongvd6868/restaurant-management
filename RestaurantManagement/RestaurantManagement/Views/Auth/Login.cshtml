<div class="container-fluid">
    <div class="row w-100">
        <div class="col-lg-6 image-side">
            <img src="https://png.pngtree.com/element_our/png_detail/20180918/chef-cooking-fried-chicken-and-delicious-sign-png_103460.jpg"
                 alt="Burger">
        </div>

        <!-- Cột form -->
        <div class="col-lg-6 form-side">
            <div class="form-container">
                <h2 class="text-center mb-4">Login</h2>

                <form method="post" action="@Url.Action("SignIn", "Auth")" id="loginForm">

                    <!-- Hiển thị thông báo lỗi -->
                    <div id="errorMessage" class="text-danger text-center mb-3" style="display: none;"></div>

                    <div class="mb-3">
                        <input type="email" id="email" class="form-control" placeholder="E-mail" name="Email" required>
                    </div>
                    <div class="mb-3">
                        <input type="password" id="password" class="form-control" placeholder="Password" name="Password" required>
                    </div>

                    <button type="submit" class="btn btn-signup">Sign In</button>

                    <!-- Mục đăng ký -->
                    <p class="text-center mt-3">
                        Don't have an account?
                        <a href="@Url.Action("Register", "Auth")" class="text-danger">Sign up</a>
                    </p>

                    <!-- Nút Back to Home -->
                    <div class="text-center mt-3">
                        <a href="@Url.Action("Index", "Home")" class="btn btn-outline-secondary">⬅ Back to Home</a>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    $(document).ready(function() {
        $('#loginForm').submit(async function(e) {
            e.preventDefault();

            const email = $('#email').val();
            const password = $('#password').val();
            const errorMessage = $('#errorMessage');

            try {
                const response = await fetch("/auth/LoginHandle", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ Email: email, Password: password })
                });

                if (!response.ok) {
                    throw new Error("Invalid email or password");
                }

                const data = await response.json();
                localStorage.setItem("accessToken", data.accessToken);
                const role = data.role;
                if (role === "Customer") {
                    window.location.href = "/"; // Redirect đến trang home cho user
                } else if (role === "Admin") {
                    window.location.href = "/restaurants"; // Redirect đến trang admin cho admin
                }
            } catch (error) {
                console.log(error);
                // Hiển thị lỗi khi đăng nhập thất bại
                errorMessage.text(error.message).show();
            }
        });
    });
</script>
